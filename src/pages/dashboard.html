<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Painel do Usu√°rio - Eco Doa√ß√£o</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="src/assets/styles/style.css">
  </head>
  <body>
    <div class="login-container container py-5">
      <div class="logo-area text-center mb-4">
        <img src="/src/assets/img/logo-eco-doacao.png" alt="Logo Capivara e Jacar√©" style="max-width:140px;">
        <h1 class="h4 mt-2">Painel do Usu√°rio</h1>
      </div>

      <div class="row gy-3">
        <div class="col-12 col-md-4">
          <div class="card text-center shadow-sm p-3">
            <h5>Saldo Atual</h5>
            <div class="fs-4 mt-2" id="userBalance">üí∞ <span id="balanceAmount">250</span> Moedas</div>
            <p class="text-muted small">Continue ajudando e acumule mais recompensas!</p>
          </div>
        </div>
        <div class="col-12 col-md-8">
          <div class="card shadow-sm p-3">
            <h5>Suas Conquistas</h5>
            <div class="d-flex gap-3 flex-wrap mt-3">
              <div class="text-center" data-badge-id="1">
                <img src="/src/assets/img/badge1.svg" alt="Primeira Doa√ß√£o" style="width:64px;height:64px;">
                <div class="small">Primeira Doa√ß√£o</div>
              </div>
              <div class="text-center" data-badge-id="2">
                <img src="/src/assets/img/badge2.svg" alt="Her√≥i Verde" style="width:64px;height:64px;">
                <div class="small">Her√≥i Verde</div>
              </div>
              <div class="text-center" data-badge-id="3">
                <img src="/src/assets/img/badge3.svg" alt="Reciclador Ouro" style="width:64px;height:64px;">
                <div class="small">Reciclador Ouro</div>
              </div>
              <div class="text-center" data-badge-id="4">
                <img src="/src/assets/img/badge4.svg" alt="Reciclagem Exemplar" style="width:64px;height:64px;">
                <div class="small">Reciclagem Exemplar</div>
              </div>
              <div class="text-center" data-badge-id="5">
                <img src="/src/assets/img/badge5.svg" alt="Estrela de M√©rito" style="width:64px;height:64px;">
                <div class="small">Estrela de M√©rito</div>
              </div>
              <div class="text-center" data-badge-id="6">
                <img src="/src/assets/img/badge6.svg" alt="Desafio Cumprido" style="width:64px;height:64px;">
                <div class="small">Desafio Cumprido</div>
              </div>
            </div>
          </div>
        </div>

        <div class="col-12">
          <div class="d-flex gap-2">
            <a class="btn btn-success" href="submissao.html">Nova Doa√ß√£o</a>
            <a class="btn btn-outline-secondary" href="historico.html">Hist√≥rico de Doa√ß√µes</a>
            <a class="btn btn-outline-secondary" href="galeria.html">Galeria de Badges</a>
          </div>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      // Marcar badges adquiridas (leitura de localStorage)
      (function(){
        function markOwned() {
          try {
            const raw = localStorage.getItem('ecodoacao_owned_badges');
            if (!raw) return;
            const owned = JSON.parse(raw);
            for (const id of owned) {
              const el = document.querySelector(`.text-center[data-badge-id="${id}"]`);
              if (!el) continue;
                // Marcar badges adquiridas (visual + overlay)
                const owned = JSON.parse(localStorage.getItem('ecodoacao_owned_badges') || '[]');
                owned.forEach(id => {
                  const el = document.querySelector(`[data-badge-id="${id}"]`);
                  if (el) {
                    el.classList.add('owned');
                    // criar overlay se n√£o existir
                    if (!el.querySelector('.owned-overlay')) {
                      const overlay = document.createElement('div');
                      overlay.className = 'owned-overlay';
                      overlay.innerHTML = '<span class="dot"></span><span style="margin-left:6px">Conquistada</span>';
                      el.appendChild(overlay);
                    }
                  }
                });
            }
          } catch (e) {
            // ignore
          }
        }
        if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', markOwned);
        else markOwned();
      })();
    </script>
    <script type="module" src="/src/core/app.ts"></script>
  </body>
</html>