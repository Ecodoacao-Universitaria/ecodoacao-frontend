(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))i(e);new MutationObserver(e=>{for(const t of e)if(t.type==="childList")for(const s of t.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function o(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?t.credentials="include":e.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function i(e){if(e.ep)return;e.ep=!0;const t=o(e);fetch(e.href,t)}})();function f(){let a=document.getElementById("toast-container");return a||(a=document.createElement("div"),a.id="toast-container",a.className="position-fixed top-0 end-0 p-3",a.style.zIndex="1080",document.body.appendChild(a)),a}function r(a,n="success",o=3e3){const i=f(),e=document.createElement("div");e.className="toast",e.setAttribute("role","status"),e.setAttribute("aria-live","polite"),e.setAttribute("aria-atomic","true"),e.innerHTML=`
    <div class="toast-header bg-${n} text-white">
      <strong class="me-auto">Eco Doação</strong>
      <button type="button" class="btn-close btn-close-white ms-2 mb-1" data-bs-dismiss="toast" aria-label="Close"></button>
    </div>
    <div class="toast-body">
      ${l(a)}
    </div>
  `,i.appendChild(e);try{const t=window.bootstrap?.Toast;if(t){new t(e,{delay:o}).show(),e.addEventListener("hidden.bs.toast",()=>e.remove());return}}catch{}e.classList.add("show"),setTimeout(()=>{e.classList.remove("show"),e.remove()},o+500)}function l(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function d(){const a=localStorage.getItem("ecodoacao_submissions");if(!a)return[];try{return JSON.parse(a)}catch{return[]}}function v(a){const n=d();n.unshift(a),localStorage.setItem("ecodoacao_submissions",JSON.stringify(n))}function g(){const a=document.getElementById("historicoList");if(!a)return;const n=d();p(a,n)}function p(a,n){if(a.innerHTML="",!n||!n.length){const o=document.createElement("li");o.className="list-group-item text-muted",o.innerText="Nenhuma doação registrada ainda.",a.appendChild(o);return}n.forEach(o=>{const i=document.createElement("li");i.className="list-group-item d-flex justify-content-between align-items-start";const e=document.createElement("div");e.innerHTML=`<div class="fw-bold">${l(o.tipo)}</div><div class="text-muted small">${l(o.descricao)}</div><div class="text-muted small">${new Date(o.data).toLocaleString()}</div>`;const t=document.createElement("div"),s=o.status.toLowerCase().includes("aprov")?"bg-success":o.status.toLowerCase().includes("enviado")?"bg-warning text-dark":"bg-secondary";t.innerHTML=`<span class="badge ${s}">${l(o.status)}</span>`,i.appendChild(e),i.appendChild(t),a.appendChild(i)})}document.addEventListener("DOMContentLoaded",()=>{a();function a(){if(document.getElementById("ecodoacao-navbar"))return;const e=document.createElement("nav");e.id="ecodoacao-navbar",e.className="navbar navbar-expand-lg navbar-light bg-white border-bottom fixed-top",e.innerHTML=`
      <div class="container">
        <a class="navbar-brand d-flex align-items-center gap-2" href="index.html">
          <img src="imagem/logo-eco-doacao.png" alt="logo" style="height:34px;" />
          <span class="fw-bold text-success">Eco Doação</span>
        </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#ecodoacaoNavMenu" aria-controls="ecodoacaoNavMenu" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="ecodoacaoNavMenu">
          <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
            <li class="nav-item"><a class="nav-link" href="index.html">Entrar</a></li>
            <li class="nav-item"><a class="nav-link" href="cadastro.html">Cadastro</a></li>
            <li class="nav-item"><a class="nav-link" href="dashboard.html">Painel</a></li>
            <li class="nav-item"><a class="nav-link" href="submissao.html">Nova Doação</a></li>
            <li class="nav-item"><a class="nav-link" href="historico.html">Histórico</a></li>
          </ul>
        </div>
      </div>
    `,document.body.prepend(e);const t=window.location.pathname.split("/").pop()||"index.html";document.querySelectorAll("#ecodoacao-navbar .nav-link").forEach(s=>{(s.getAttribute("href")||"")===t&&s.classList.add("active")})}const n=document.getElementById("loginForm");n&&n.addEventListener("submit",e=>{if(e.preventDefault(),!(document.getElementById("email")?.value||"").endsWith("@ufrpe.br")){r("Use seu e-mail institucional (@ufrpe.br)","danger");return}r("Login realizado com sucesso!","success"),setTimeout(()=>window.location.href="dashboard.html",700)});const o=document.getElementById("cadastroForm");o&&o.addEventListener("submit",e=>{e.preventDefault();const t=document.getElementById("email")?.value||"",s=document.getElementById("senha")?.value||"",c=document.getElementById("confirmar")?.value||"";if(!t.endsWith("@ufrpe.br")){r("O e-mail deve ser institucional (@ufrpe.br)","danger");return}if(s!==c){r("As senhas não coincidem!","warning");return}r("Cadastro realizado com sucesso!","success"),setTimeout(()=>window.location.href="dashboard.html",700)});const i=document.getElementById("doacaoForm");i&&i.addEventListener("submit",e=>{e.preventDefault();const t=document.getElementById("foto");if(!t||!t.files||t.files.length===0){r("Envie uma foto da doação.","warning");return}const s=document.getElementById("tipo")?.value||"Outro",c=document.getElementById("descricao")?.value||"",u=t&&t.files&&t.files[0]?t.files[0].name:void 0,m={id:Date.now(),tipo:s,descricao:c,arquivoNome:u,data:new Date().toISOString(),status:"Enviado para validação"};v(m),r("Doação salva localmente e enviada para validação (simulado)","success"),setTimeout(()=>window.location.href="historico.html",700)}),document.querySelectorAll("[data-href]").forEach(e=>{e.addEventListener("click",()=>{const t=e.getAttribute("data-href");t&&(window.location.href=t)})}),g()});
